# 08_ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆ

**ä½œæˆæ—¥**: 2025-10-25
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡

---

## ç›®æ¬¡
1. [ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆæ¦‚è¦](#ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆæ¦‚è¦)
2. [CloudWatch Logsè¨­è¨ˆ](#cloudwatch-logsè¨­è¨ˆ)
3. [CloudWatch Metricsè¨­è¨ˆ](#cloudwatch-metricsè¨­è¨ˆ)
4. [CloudWatch Alarmsè¨­è¨ˆ](#cloudwatch-alarmsè¨­è¨ˆ)
5. [SNSé€šçŸ¥è¨­è¨ˆ](#snsé€šçŸ¥è¨­è¨ˆ)
6. [ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­è¨ˆ](#ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­è¨ˆ)
7. [é‹ç”¨æ‰‹é †](#é‹ç”¨æ‰‹é †)

---

## ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆæ¦‚è¦

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```mermaid
graph TB
    subgraph "VPC-Prod"
        ECS[ECS Fargate]
        ALB[ALB]
        RDS[RDS PostgreSQL]
    end

    subgraph "CloudWatch"
        Logs[CloudWatch Logs]
        Metrics[CloudWatch Metrics]
        Alarms[CloudWatch Alarms]
        Dashboard[CloudWatch Dashboard]
    end

    subgraph "é€šçŸ¥"
        SNS[SNS Topic]
        Email[Email]
        Slack[Slack]
        Teams[Microsoft Teams]
    end

    ECS -->|ãƒ­ã‚°| Logs
    ALB -->|ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°| Logs
    RDS -->|ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªãƒ­ã‚°| Logs

    ECS -->|ãƒ¡ãƒˆãƒªã‚¯ã‚¹| Metrics
    ALB -->|ãƒ¡ãƒˆãƒªã‚¯ã‚¹| Metrics
    RDS -->|ãƒ¡ãƒˆãƒªã‚¯ã‚¹| Metrics

    Metrics -->|é–¾å€¤è¶…é| Alarms
    Alarms -->|é€šçŸ¥| SNS
    SNS -->|ãƒ¡ãƒ¼ãƒ«| Email
    SNS -->|Webhook| Slack
    SNS -->|Webhook| Teams

    Metrics -->|å¯è¦–åŒ–| Dashboard
```

### ç›£è¦–å¯¾è±¡ä¸€è¦§

| ã‚«ãƒ†ã‚´ãƒª | ç›£è¦–å¯¾è±¡ | ç›£è¦–é …ç›® | ã‚¢ãƒ©ãƒ¼ãƒˆåŸºæº– |
|---------|---------|---------|------------|
| **ECS** | Fargate Task | CPUä½¿ç”¨ç‡ã€ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ã€ã‚¿ã‚¹ã‚¯æ•° | CPU 80%ã€ãƒ¡ãƒ¢ãƒª 80% |
| **ALB** | Load Balancer | ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã€5xxã‚¨ãƒ©ãƒ¼ | 5xxã‚¨ãƒ©ãƒ¼ç‡ 5%ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· 1ç§’ |
| **RDS** | PostgreSQL | CPUä½¿ç”¨ç‡ã€æ¥ç¶šæ•°ã€ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ | CPU 80%ã€æ¥ç¶šæ•° 80%ã€ãƒ‡ã‚£ã‚¹ã‚¯ 80% |
| **Network** | Transit Gateway | ãƒ‡ãƒ¼ã‚¿è»¢é€é‡ã€ãƒ‘ã‚±ãƒƒãƒˆãƒ‰ãƒ­ãƒƒãƒ— | ãƒ‘ã‚±ãƒƒãƒˆãƒ‰ãƒ­ãƒƒãƒ—ç‡ 1% |
| **Security** | GuardDuty | è„…å¨æ¤œå‡ºã€ç•°å¸¸æ¤œçŸ¥ | ä¸­ä»¥ä¸Šã®æ¤œå‡º |
| **Cost** | AWS Cost | æ—¥æ¬¡ã‚³ã‚¹ãƒˆ | äºˆç®—ã®80%è¶…é |

---

## CloudWatch Logsè¨­è¨ˆ

### ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§

| ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—å | èª¬æ˜ | ä¿æŒæœŸé–“ | æš—å·åŒ– |
|--------------|------|---------|--------|
| `/ecs/admin-api` | æ¥­å‹™APIã‚³ãƒ³ãƒ†ãƒŠãƒ­ã‚° | 30æ—¥ï¼ˆæœ¬ç•ªï¼‰ã€7æ—¥ï¼ˆDev/Stgï¼‰ | KMS |
| `/ecs/vendor-api` | äº‹æ¥­è€…APIã‚³ãƒ³ãƒ†ãƒŠãƒ­ã‚° | 30æ—¥ï¼ˆæœ¬ç•ªï¼‰ã€7æ—¥ï¼ˆDev/Stgï¼‰ | KMS |
| `/ecs/batch` | ãƒãƒƒãƒå‡¦ç†ãƒ­ã‚° | 90æ—¥ | KMS |
| `/aws/lambda/*` | Lambdaé–¢æ•°ãƒ­ã‚° | 14æ—¥ | KMS |
| `/aws/rds/instance/facility-prod-db/slowquery` | RDSã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªãƒ­ã‚° | 30æ—¥ | KMS |
| `/aws/elasticloadbalancing/alb/internal-alb` | Internal ALBã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚° | 30æ—¥ | KMS |
| `/aws/elasticloadbalancing/alb/public-alb` | Public ALBã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚° | 30æ—¥ | KMS |
| `/aws/vpc/flowlogs` | VPCãƒ•ãƒ­ãƒ¼ãƒ­ã‚° | 7æ—¥ | KMS |

### ãƒ­ã‚°ã‚°ãƒ«ãƒ¼ãƒ—å®šç¾©ï¼ˆCloudFormationï¼‰

```yaml
AdminAPILogGroup:
  Type: AWS::Logs::LogGroup
  Properties:
    LogGroupName: /ecs/admin-api
    RetentionInDays: !If [IsProduction, 30, 7]
    KmsKeyId: !GetAtt LogsKMSKey.Arn

VendorAPILogGroup:
  Type: AWS::Logs::LogGroup
  Properties:
    LogGroupName: /ecs/vendor-api
    RetentionInDays: !If [IsProduction, 30, 7]
    KmsKeyId: !GetAtt LogsKMSKey.Arn

BatchLogGroup:
  Type: AWS::Logs::LogGroup
  Properties:
    LogGroupName: /ecs/batch
    RetentionInDays: 90
    KmsKeyId: !GetAtt LogsKMSKey.Arn
```

### ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆæ§‹é€ åŒ–ãƒ­ã‚°ï¼‰

**æ¨å¥¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆJSONï¼‰**:
```json
{
  "timestamp": "2025-10-25T12:34:56.789Z",
  "level": "INFO",
  "service": "admin-api",
  "traceId": "abc123...",
  "userId": "staff-001",
  "method": "POST",
  "path": "/api/orders",
  "statusCode": 200,
  "duration": 123,
  "message": "Order created successfully"
}
```

**Node.jså®Ÿè£…ä¾‹ï¼ˆWinstonï¼‰**:
```javascript
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  defaultMeta: { service: 'admin-api' },
  transports: [
    new winston.transports.Console()
  ]
});

// ä½¿ç”¨ä¾‹
logger.info('Order created', {
  userId: 'staff-001',
  orderId: 'order-123',
  duration: 123
});
```

### CloudWatch Logs Insights ã‚¯ã‚¨ãƒªä¾‹

**5xxã‚¨ãƒ©ãƒ¼ã®é›†è¨ˆ**:
```sql
fields @timestamp, level, message, statusCode
| filter statusCode >= 500
| stats count() as errorCount by statusCode
| sort errorCount desc
```

**ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·åˆ†æ**:
```sql
fields @timestamp, path, duration
| filter method = "POST"
| stats avg(duration), max(duration), pct(duration, 95) by path
```

---

## CloudWatch Metricsè¨­è¨ˆ

### ECS Metrics

```yaml
ECSCPUUtilization:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-ecs-cpu-high
    AlarmDescription: ECS CPU utilization is too high
    MetricName: CPUUtilization
    Namespace: AWS/ECS
    Statistic: Average
    Period: 300                         # 5åˆ†é–“
    EvaluationPeriods: 2                # 2å›é€£ç¶š
    Threshold: 80                       # 80%
    ComparisonOperator: GreaterThanThreshold
    Dimensions:
      - Name: ClusterName
        Value: !Ref ECSCluster
      - Name: ServiceName
        Value: !GetAtt AdminAPIService.Name
    AlarmActions:
      - !Ref SNSTopic
    TreatMissingData: notBreaching

ECSMemoryUtilization:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-ecs-memory-high
    AlarmDescription: ECS Memory utilization is too high
    MetricName: MemoryUtilization
    Namespace: AWS/ECS
    Statistic: Average
    Period: 300
    EvaluationPeriods: 2
    Threshold: 80
    ComparisonOperator: GreaterThanThreshold
    Dimensions:
      - Name: ClusterName
        Value: !Ref ECSCluster
      - Name: ServiceName
        Value: !GetAtt AdminAPIService.Name
    AlarmActions:
      - !Ref SNSTopic
    TreatMissingData: notBreaching
```

### ALB Metrics

```yaml
ALBTargetResponseTime:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-alb-latency-high
    AlarmDescription: ALB response time is too high
    MetricName: TargetResponseTime
    Namespace: AWS/ApplicationELB
    Statistic: Average
    Period: 300
    EvaluationPeriods: 2
    Threshold: 1.0                      # 1ç§’
    ComparisonOperator: GreaterThanThreshold
    Dimensions:
      - Name: LoadBalancer
        Value: !GetAtt InternalALB.LoadBalancerFullName
    AlarmActions:
      - !Ref SNSTopic

ALB5XXErrorRate:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-alb-5xx-error-rate
    AlarmDescription: ALB 5xx error rate is too high
    MetricName: HTTPCode_Target_5XX_Count
    Namespace: AWS/ApplicationELB
    Statistic: Sum
    Period: 300
    EvaluationPeriods: 1
    Threshold: 10                       # 5åˆ†é–“ã§10å›ä»¥ä¸Š
    ComparisonOperator: GreaterThanThreshold
    Dimensions:
      - Name: LoadBalancer
        Value: !GetAtt InternalALB.LoadBalancerFullName
    AlarmActions:
      - !Ref SNSTopic
```

### RDS Metrics

```yaml
RDSCPUUtilization:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-rds-cpu-high
    AlarmDescription: RDS CPU utilization is too high
    MetricName: CPUUtilization
    Namespace: AWS/RDS
    Statistic: Average
    Period: 300
    EvaluationPeriods: 2
    Threshold: 80
    ComparisonOperator: GreaterThanThreshold
    Dimensions:
      - Name: DBInstanceIdentifier
        Value: !Ref RDSInstance
    AlarmActions:
      - !Ref SNSTopic

RDSDatabaseConnections:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-rds-connections-high
    AlarmDescription: RDS database connections are too high
    MetricName: DatabaseConnections
    Namespace: AWS/RDS
    Statistic: Average
    Period: 300
    EvaluationPeriods: 2
    Threshold: 80                       # max_connections ã®80%
    ComparisonOperator: GreaterThanThreshold
    Dimensions:
      - Name: DBInstanceIdentifier
        Value: !Ref RDSInstance
    AlarmActions:
      - !Ref SNSTopic

RDSFreeStorageSpace:
  Type: AWS::CloudWatch::Alarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-rds-storage-low
    AlarmDescription: RDS free storage space is too low
    MetricName: FreeStorageSpace
    Namespace: AWS/RDS
    Statistic: Average
    Period: 300
    EvaluationPeriods: 1
    Threshold: 10737418240              # 10GB
    ComparisonOperator: LessThanThreshold
    Dimensions:
      - Name: DBInstanceIdentifier
        Value: !Ref RDSInstance
    AlarmActions:
      - !Ref SNSTopic
```

---

## CloudWatch Alarmsè¨­è¨ˆ

### ã‚¢ãƒ©ãƒ¼ãƒˆé‡è¦åº¦ãƒ¬ãƒ™ãƒ«

| ãƒ¬ãƒ™ãƒ« | èª¬æ˜ | å¯¾å¿œSLA | é€šçŸ¥å…ˆ |
|-------|------|---------|--------|
| **Critical** | ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ã€ãƒ‡ãƒ¼ã‚¿æå¤±ãƒªã‚¹ã‚¯ | å³åº§ï¼ˆ15åˆ†ä»¥å†…ï¼‰ | Email + Slack + é›»è©± |
| **High** | æ€§èƒ½åŠ£åŒ–ã€ä¸€éƒ¨æ©Ÿèƒ½åœæ­¢ | 1æ™‚é–“ä»¥å†… | Email + Slack |
| **Medium** | æ€§èƒ½ä½ä¸‹ã®å…†å€™ | å–¶æ¥­æ™‚é–“å†… | Email |
| **Low** | æƒ…å ±æä¾› | - | ãƒ­ã‚°ã®ã¿ |

### ã‚¢ãƒ©ãƒ¼ãƒ ä¸€è¦§

#### Criticalï¼ˆé‡å¤§ï¼‰

| ã‚¢ãƒ©ãƒ¼ãƒ å | æ¡ä»¶ | é–¾å€¤ | èª¬æ˜ |
|----------|------|------|------|
| `rds-instance-down` | RDS DatabaseConnections = 0 | 5åˆ†é–“ | DBåœæ­¢ |
| `ecs-service-running-count-zero` | ECS RunningTaskCount = 0 | 5åˆ†é–“ | APIåœæ­¢ |
| `alb-unhealthy-host-count` | UnHealthyHostCount > 0 | 5åˆ†é–“ | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å¤±æ•— |

#### Highï¼ˆé«˜ï¼‰

| ã‚¢ãƒ©ãƒ¼ãƒ å | æ¡ä»¶ | é–¾å€¤ | èª¬æ˜ |
|----------|------|------|------|
| `rds-cpu-high` | RDS CPUUtilization > 80% | 2å›é€£ç¶š | DBé«˜è² è· |
| `ecs-cpu-high` | ECS CPUUtilization > 80% | 2å›é€£ç¶š | APIé«˜è² è· |
| `alb-5xx-error-rate` | HTTPCode_Target_5XX_Count > 10 | 5åˆ†é–“ | ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ |
| `rds-storage-low` | FreeStorageSpace < 10GB | 1å› | ãƒ‡ã‚£ã‚¹ã‚¯ä¸è¶³ |

#### Mediumï¼ˆä¸­ï¼‰

| ã‚¢ãƒ©ãƒ¼ãƒ å | æ¡ä»¶ | é–¾å€¤ | èª¬æ˜ |
|----------|------|------|------|
| `alb-latency-high` | TargetResponseTime > 1.0s | 2å›é€£ç¶š | ãƒ¬ã‚¹ãƒãƒ³ã‚¹é…å»¶ |
| `rds-connections-high` | DatabaseConnections > 80 | 2å›é€£ç¶š | æ¥ç¶šæ•°å¢—åŠ  |

### è¤‡åˆã‚¢ãƒ©ãƒ¼ãƒ ï¼ˆComposite Alarmï¼‰

```yaml
ServiceHealthCompositeAlarm:
  Type: AWS::CloudWatch::CompositeAlarm
  Properties:
    AlarmName: !Sub ${ProjectName}-${Environment}-service-health
    AlarmDescription: Overall service health check
    AlarmRule: !Sub |
      ALARM(${RDSCPUUtilization}) OR
      ALARM(${ECSCPUUtilization}) OR
      ALARM(${ALB5XXErrorRate})
    ActionsEnabled: true
    AlarmActions:
      - !Ref CriticalSNSTopic
```

---

## SNSé€šçŸ¥è¨­è¨ˆ

### SNS Topicæ§‹æˆ

```yaml
CriticalSNSTopic:
  Type: AWS::SNS::Topic
  Properties:
    DisplayName: Critical Alerts
    TopicName: !Sub ${ProjectName}-${Environment}-critical-alerts
    KmsMasterKeyId: !Ref SNSKMSKey

HighSNSTopic:
  Type: AWS::SNS::Topic
  Properties:
    DisplayName: High Priority Alerts
    TopicName: !Sub ${ProjectName}-${Environment}-high-alerts
    KmsMasterKeyId: !Ref SNSKMSKey

MediumSNSTopic:
  Type: AWS::SNS::Topic
  Properties:
    DisplayName: Medium Priority Alerts
    TopicName: !Sub ${ProjectName}-${Environment}-medium-alerts
    KmsMasterKeyId: !Ref SNSKMSKey
```

### Emailè³¼èª­

```yaml
CriticalEmailSubscription:
  Type: AWS::SNS::Subscription
  Properties:
    Protocol: email
    TopicArn: !Ref CriticalSNSTopic
    Endpoint: ops-critical@example.com

HighEmailSubscription:
  Type: AWS::SNS::Subscription
  Properties:
    Protocol: email
    TopicArn: !Ref HighSNSTopic
    Endpoint: ops-team@example.com
```

### Slacké€šçŸ¥ï¼ˆLambdaçµŒç”±ï¼‰

```yaml
SlackNotificationFunction:
  Type: AWS::Lambda::Function
  Properties:
    FunctionName: !Sub ${ProjectName}-${Environment}-slack-notification
    Runtime: python3.11
    Handler: index.lambda_handler
    Role: !GetAtt LambdaExecutionRole.Arn
    Environment:
      Variables:
        SLACK_WEBHOOK_URL: !Ref SlackWebhookURL
    Code:
      ZipFile: |
        import json
        import urllib.request
        import os

        def lambda_handler(event, context):
            message = json.loads(event['Records'][0]['Sns']['Message'])
            alarm_name = message['AlarmName']
            new_state = message['NewStateValue']
            reason = message['NewStateReason']

            slack_message = {
                'text': f'ğŸš¨ CloudWatch Alarm: {alarm_name}',
                'attachments': [
                    {
                        'color': 'danger' if new_state == 'ALARM' else 'good',
                        'fields': [
                            {'title': 'State', 'value': new_state, 'short': True},
                            {'title': 'Reason', 'value': reason, 'short': False}
                        ]
                    }
                ]
            }

            req = urllib.request.Request(
                os.environ['SLACK_WEBHOOK_URL'],
                data=json.dumps(slack_message).encode('utf-8'),
                headers={'Content-Type': 'application/json'}
            )
            urllib.request.urlopen(req)
            return {'statusCode': 200}

SlackSubscription:
  Type: AWS::SNS::Subscription
  Properties:
    Protocol: lambda
    TopicArn: !Ref CriticalSNSTopic
    Endpoint: !GetAtt SlackNotificationFunction.Arn
```

---

## ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­è¨ˆ

### CloudWatch Dashboard

```yaml
MainDashboard:
  Type: AWS::CloudWatch::Dashboard
  Properties:
    DashboardName: !Sub ${ProjectName}-${Environment}-main
    DashboardBody: !Sub |
      {
        "widgets": [
          {
            "type": "metric",
            "properties": {
              "metrics": [
                ["AWS/ECS", "CPUUtilization", {"stat": "Average"}],
                [".", "MemoryUtilization", {"stat": "Average"}]
              ],
              "period": 300,
              "stat": "Average",
              "region": "${AWS::Region}",
              "title": "ECS CPU & Memory"
            }
          },
          {
            "type": "metric",
            "properties": {
              "metrics": [
                ["AWS/ApplicationELB", "TargetResponseTime", {"stat": "Average"}],
                [".", "RequestCount", {"stat": "Sum"}]
              ],
              "period": 300,
              "stat": "Average",
              "region": "${AWS::Region}",
              "title": "ALB Performance"
            }
          },
          {
            "type": "metric",
            "properties": {
              "metrics": [
                ["AWS/RDS", "CPUUtilization", {"stat": "Average"}],
                [".", "DatabaseConnections", {"stat": "Average"}]
              ],
              "period": 300,
              "stat": "Average",
              "region": "${AWS::Region}",
              "title": "RDS Performance"
            }
          }
        ]
      }
```

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ§‹æˆ

**ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**:
1. ECS: CPUä½¿ç”¨ç‡ã€ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ã€ã‚¿ã‚¹ã‚¯æ•°
2. ALB: ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã€5xxã‚¨ãƒ©ãƒ¼ç‡
3. RDS: CPUä½¿ç”¨ç‡ã€æ¥ç¶šæ•°ã€ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡
4. Network: ãƒ‡ãƒ¼ã‚¿è»¢é€é‡ã€ãƒ‘ã‚±ãƒƒãƒˆãƒ‰ãƒ­ãƒƒãƒ—ç‡

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**:
1. GuardDuty: è„…å¨æ¤œå‡ºä»¶æ•°
2. WAF: ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
3. CloudTrail: ç•°å¸¸ãªAPIå‘¼ã³å‡ºã—

---

## é‹ç”¨æ‰‹é †

### ã‚¢ãƒ©ãƒ¼ãƒˆå¯¾å¿œãƒ•ãƒ­ãƒ¼

```mermaid
graph TD
    Alert[CloudWatch Alarmç™ºç«]
    Notify[SNSé€šçŸ¥]
    Check{é‡è¦åº¦}
    Critical[Critical<br/>å³åº§ã«å¯¾å¿œ]
    High[High<br/>1æ™‚é–“ä»¥å†…]
    Medium[Medium<br/>å–¶æ¥­æ™‚é–“å†…]
    Investigate[åŸå› èª¿æŸ»]
    Fix[å¯¾ç­–å®Ÿæ–½]
    Resolve[ã‚¢ãƒ©ãƒ¼ãƒˆè§£æ¶ˆ]
    PostMortem[äº‹å¾Œãƒ¬ãƒ“ãƒ¥ãƒ¼]

    Alert --> Notify
    Notify --> Check
    Check -->|Critical| Critical
    Check -->|High| High
    Check -->|Medium| Medium
    Critical --> Investigate
    High --> Investigate
    Medium --> Investigate
    Investigate --> Fix
    Fix --> Resolve
    Resolve --> PostMortem
```

### éšœå®³å¯¾å¿œæ‰‹é †æ›¸

**ECS CPUé«˜è² è·æ™‚**:
1. CloudWatch Logsã§ç›´è¿‘ã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
2. Auto ScalingãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦æ‰‹å‹•ã§ã‚¿ã‚¹ã‚¯æ•°ã‚’å¢—ã‚„ã™
4. åŸå› ç‰¹å®šå¾Œã€ã‚³ãƒ¼ãƒ‰ä¿®æ­£ã¾ãŸã¯ãƒªã‚½ãƒ¼ã‚¹å¢—å¼·

**RDSæ¥ç¶šæ•°å¢—åŠ æ™‚**:
1. CloudWatch Logsã§ã‚¹ãƒ­ãƒ¼ã‚¯ã‚¨ãƒªãƒ­ã‚°ã‚’ç¢ºèª
2. é•·æ™‚é–“å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚¯ã‚¨ãƒªã‚’KILL
3. ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã®è¨­å®šã‚’ç¢ºèª
4. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ ã‚’æ¤œè¨

**ALB 5xxã‚¨ãƒ©ãƒ¼æ™‚**:
1. ECS Task Definitionã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ‘ã‚¹ã‚’ç¢ºèª
2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã§ä¾‹å¤–ã‚’ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
4. æ ¹æœ¬åŸå› ã®ä¿®æ­£

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

- [09_CI_CDè¨­è¨ˆ.md](09_CI_CDè¨­è¨ˆ.md): GitHub Actionsã€ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- [10_CloudFormationæ§‹æˆæ–¹é‡.md](10_CloudFormationæ§‹æˆæ–¹é‡.md): ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²3åŸå‰‡

---

**ä½œæˆè€…**: Architectï¼ˆClaudeï¼‰
**ãƒ¬ãƒ“ãƒ¥ãƒ¼çŠ¶æ…‹**: ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡
