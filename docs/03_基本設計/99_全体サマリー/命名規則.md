# 命名規則

**作成日**: 2025-10-25
**バージョン**: 1.3
**ステータス**: ユーザー承認完了、実装開始

---

## 概要

このドキュメントは、CloudFormationテンプレート、AWSリソース、アプリケーションコードで使用する命名規則を定義します。

---

## 11. 命名規則

### 11.1 リソース命名規則

**基本フォーマット**:
```
{project}-{env}-{resource}-{optional}

例:
- facilities-prod-cluster
- facilities-prod-db
- facilities-staff-api
```

| プレフィックス | 説明 | 例 |
|------------|------|---|
| facilities | プロジェクト名 | - |
| dev / stg / prod | 環境 | - |
| cluster | ECS Cluster | facilities-prod-cluster |
| db | RDS Instance | facilities-prod-db |
| alb | ALB | facilities-staff-alb |
| vpc | VPC | facilities-prod-vpc |

### 11.2 主要リソースの命名例

#### ネットワーク（Shared Account）

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| Transit Gateway | facilities-shared-tgw | ハブアカウントの共有TGW |
| Client VPN Endpoint | facilities-shared-client-vpn | 拠点接続用 |
| Transit Gateway Route Table | tgw-rtb-on-premises | 拠点向けルートテーブル |
| Transit Gateway Route Table | tgw-rtb-service-vpc | Service VPC向けルートテーブル |

#### ネットワーク（Service Account）

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| VPC | facilities-{env}-vpc | 環境ごと |
| Public Subnet | facilities-{env}-public-1a | AZを含む |
| Private Subnet | facilities-{env}-private-1a | AZを含む |
| DB Subnet | facilities-{env}-db-1a | AZを含む |
| NAT Gateway | facilities-{env}-natgw-1a | AZごと |
| Internet Gateway | facilities-{env}-igw | 環境ごと |
| Security Group（ALB） | facilities-{env}-sg-alb | 用途別 |
| Security Group（ECS） | facilities-{env}-sg-ecs | 用途別 |
| Security Group（RDS） | facilities-{env}-sg-rds | 用途別 |

#### コンピューティング

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| ECS Cluster | facilities-{env}-cluster | |
| ECS Task Definition | facilities-staff-api | アプリ種別 |
| ECS Task Definition | facilities-vendor-api | アプリ種別 |
| ECS Task Definition | facilities-batch | バッチ処理 |
| ECS Service | facilities-{env}-staff-api | |
| ECS Service | facilities-{env}-vendor-api | |

#### データベース

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| RDS Instance | facilities-{env}-db | |
| DB Subnet Group | facilities-{env}-db-subnet-group | |
| DB Parameter Group | facilities-{env}-pg14-custom | PostgreSQL 14 |

#### ロードバランサー

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| ALB（職員用） | facilities-staff-alb | internal |
| ALB（事業者用） | facilities-vendor-alb | internet-facing |
| Target Group | staff-api-tg | |
| Target Group | vendor-api-tg | |

#### 認証認可

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| Cognito User Pool | facilities-staff-pool | 職員用 |
| Cognito User Pool | facilities-vendor-pool | 事業者用 |

#### ストレージ

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| S3 Bucket（Shared） | facilities-shared-logs | 組織レベル監査ログ |
| S3 Bucket（Service） | facilities-{env}-logs | 環境ごと |

#### 監視・ログ

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| CloudWatch Log Group | /ecs/facilities-{env}-{app} | ECSログ |
| CloudWatch Log Group | /rds/facilities-{env}-db | RDSログ |
| CloudWatch Alarm | facilities-{env}-ecs-cpu-high | メトリクス名を含む |
| SNS Topic | facilities-{env}-alerts | アラート通知 |

#### セキュリティ

| リソース種別 | 命名例 | 備考 |
|----------|--------|------|
| Secrets Manager | facilities/{env}/db-credentials | DB接続情報 |
| IAM Role | FacilitiesECSTaskExecutionRole | |
| IAM Role | FacilitiesECSTaskRole | |
| IAM Role | FacilitiesRDSMonitoringRole | |

### 11.3 CloudFormation スタック命名規則

```
{project}-{env}-{layer}

例:
- facilities-prod-network
- facilities-prod-ecs
- facilities-prod-rds
- facilities-prod-monitoring
```

| レイヤー | スタック名 | 備考 |
|---------|----------|------|
| ネットワーク | facilities-{env}-network | VPC、サブネット、NAT Gateway |
| コンピューティング | facilities-{env}-ecs | ECS Cluster、Task Definition、Service |
| データベース | facilities-{env}-rds | RDS Instance、DB Subnet Group |
| ロードバランサー | facilities-{env}-alb | ALB、Target Group |
| 認証認可 | facilities-{env}-cognito | Cognito User Pool |
| 監視 | facilities-{env}-monitoring | CloudWatch Alarms、SNS |

---

**作成者**: SRE（PM 委譲タスク）
**最終更新**: 2025-10-25
