# ストレージ - パラメーターシート

**作成日**: 2025-10-25
**バージョン**: 1.3
**ステータス**: ユーザー承認完了、実装開始

---

## 概要

このドキュメントは、S3に関するCloudFormation実装時に参照する設定値をまとめたものです。

**注**: 本プロジェクトでは、S3はログ保管用途のみで使用されます。アプリケーションデータは RDS PostgreSQL に保存されます。

---

## S3 バケット設計（ログ保管）

### Shared Account - 組織レベル監査ログ

| バケット名 | 用途 | 保存先 | ライフサイクル |
|----------|------|--------|-------------|
| facilities-shared-logs | 組織全体のログ保管 | s3://facilities-shared-logs/ | 3ヶ月～1年: Standard<br/>1年～2年: Glacier |

**サブディレクトリ構成**:
- `cloudtrail/` - CloudTrail ログ（組織全体のAPI呼び出し記録）
- `config/` - AWS Config ログ（リソース設定変更記録）

### Service Account - アプリケーションログ

| 環境 | バケット名 | 用途 | ライフサイクル |
|------|----------|------|-------------|
| dev | facilities-dev-logs | 開発環境ログ | 1ヶ月後削除 |
| stg | facilities-stg-logs | ステージング環境ログ | 3ヶ月後削除 |
| prod | facilities-prod-logs | 本番環境ログ | 3ヶ月～1年: Standard<br/>1年～2年: Glacier |

**サブディレクトリ構成**:
- `ecs/` - ECS アプリケーションログ（CloudWatch Logs からエクスポート）
- `rds/` - RDS PostgreSQL ログ（CloudWatch Logs からエクスポート）
- `alb/` - ALB アクセスログ
- `vpc-flow/` - VPC フローログ

---

## S3 バケットポリシー

### セキュリティ設定（全バケット共通）

| 設定 | 値 | 備考 |
|------|---|------|
| パブリックアクセスブロック | すべて有効 | パブリック公開禁止 |
| バージョニング | 有効 | 誤削除対策 |
| 暗号化 | SSE-S3（AES-256） | デフォルト暗号化 |
| アクセスログ | 無効 | コスト削減（必要に応じて有効化） |

---

**作成者**: SRE（PM 委譲タスク）
**最終更新**: 2025-10-25
