# セキュリティ - パラメーターシート

**作成日**: 2025-10-25
**バージョン**: 1.3
**ステータス**: ユーザー承認完了、実装開始

---

## 概要

このドキュメントは、セキュリティ設定（TLS、暗号化、IAM等）に関するCloudFormation実装時に参照する設定値をまとめたものです。

---

## 8. セキュリティパラメーター

### 8.1 TLS設定

| パラメーター | 設定値 | 備考 |
|------------|--------|------|
| TLSバージョン | TLS 1.3 | TLS 1.2以下は拒否 |
| 暗号化アルゴリズム | AES-256 | |

### 8.2 暗号化設定

| 対象 | 暗号化方式 | KMSキー | 備考 |
|------|----------|--------|------|
| RDS（保存時） | AES-256 | AWS マネージド (aws/rds) | |
| RDS（転送時） | TLS 1.3 | - | SSL/TLS必須 |
| S3 | AES-256 | SSE-S3 | ログ保管 |
| ECS環境変数 | - | Secrets Manager | DB接続情報等 |

### 8.3 Secrets Manager

| シークレット名 | 用途 | ローテーション | 備考 |
|-------------|------|------------|------|
| facilities/dev/db-credentials | dev環境 DB接続情報 | 手動 | |
| facilities/stg/db-credentials | stg環境 DB接続情報 | 手動 | |
| facilities/prod/db-credentials | prod環境 DB接続情報 | 90日自動 | ISMAP準拠 |

### 8.4 IAM ロール設計

| ロール名 | 用途 | アタッチポリシー | 信頼関係 |
|---------|------|--------------|---------|
| ECSTaskExecutionRole | ECSタスク実行権限 | AmazonECSTaskExecutionRolePolicy | ecs-tasks.amazonaws.com |
| ECSTaskRole | アプリケーション権限 | カスタムポリシー（RDS、S3、Secrets Manager） | ecs-tasks.amazonaws.com |
| RDSMonitoringRole | RDS拡張モニタリング | AmazonRDSEnhancedMonitoringRole | monitoring.rds.amazonaws.com |

### 8.5 セキュリティグループ設計

**ALB Security Group（sg-alb）**:
| 方向 | プロトコル | ポート | ソース | 備考 |
|------|----------|--------|--------|------|
| Inbound | HTTPS | 443 | 0.0.0.0/0（事業者用）<br/>拠点CIDR（職員用） | 用途により分離 |
| Outbound | HTTP | 3000 | sg-ecs | ECSタスクへ転送 |

**ECS Security Group（sg-ecs）**:
| 方向 | プロトコル | ポート | ソース | 備考 |
|------|----------|--------|--------|------|
| Inbound | HTTP | 3000 | sg-alb | ALBからの通信のみ |
| Outbound | PostgreSQL | 5432 | sg-rds | RDSへの接続 |
| Outbound | HTTPS | 443 | 0.0.0.0/0 | AWS API、外部API |

**RDS Security Group（sg-rds）**:
| 方向 | プロトコル | ポート | ソース | 備考 |
|------|----------|--------|--------|------|
| Inbound | PostgreSQL | 5432 | sg-ecs | ECSからの接続のみ |
| Outbound | - | - | - | 不要 |

---

**作成者**: SRE（PM 委譲タスク）
**最終更新**: 2025-10-25
