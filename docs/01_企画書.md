# 役所設備管理システム AWS ECS 移行プロジェクト 企画書

**作成日**: 2025-10-24
**バージョン**: 1.0
**ステータス**: レビュー待ち

---

## 1. エグゼクティブサマリー

### プロジェクト名
役所設備管理システム AWS ECS（Fargate）移行プロジェクト

### 目的
現行の設備管理システム（EC2ベース）をAWS ECS（Fargate）に移行し、サーバー管理の負荷削減、自動スケーリング、計画的なデプロイ運用を実現する。併せて、デジタル庁のガバメントクラウド移行方針に対応し、ISMAP準拠のセキュアなシステム基盤を構築する。

### 主要な効果
- **運用工数削減**: サーバー管理工数を月20時間から月5時間に削減（75%削減）
- **可用性向上**: 計画的なメンテナンス時間中にデプロイを実施し、業務時間への影響をゼロにする
- **性能改善**: ピーク時の応答時間を95%ile で 500ms 以内に抑える（現状: 5秒以上）
- **コンプライアンス**: ISMAP準拠、政府情報システムの基本方針に対応

### 予算・納期
- **初期構築費用**: 300万円以内
- **月額運用費用**: 100万円以内（AWS利用料）
- **本番稼働**: 12ヶ月以内

---

## 2. ビジネス背景

### 2.1 業種・業態
- **組織**: 役所（公的機関）
- **対象システム**: 設備管理システム（公共施設・庁舎の設備機器管理）
- **利用者**:
  - 職員（100名）: 在庫管理、発注承認、レポート閲覧
  - 事業者（発注業者）: 伝票閲覧・入力

### 2.2 移行の背景
1. **EOL対応**: 現行サーバー（EC2）のOSサポート終了
2. **ガバメントクラウド移行**: デジタル庁からの方針により、ガバメントクラウドへの移行が必須
3. **コンプライアンス要件**: ISMAP準拠、政府情報システムにおけるクラウドサービス利用の基本方針への対応

### 2.3 現状の課題

#### 課題1: サーバー管理の負荷
- 3台の EC2 インスタンスを手動で管理
- OSアップデート、セキュリティパッチ適用に月20時間
- 夜間・休日のサーバートラブル対応で緊急出社が月2-3回発生

#### 課題2: スケーラビリティの問題
- 月末の集計処理（ピーク時）にサーバーが高負荷
- 手動でインスタンスを追加・削除しており、タイムラグがある
- ピーク時の応答時間が5秒以上になることがある

#### 課題3: デプロイの課題
- Blue/Green デプロイができず、サービス停止が発生（月1回、10分程度）
- デプロイ時のロールバックが手動で30分以上かかる
- デプロイ手順書が属人化しており、担当者不在時は対応不可

#### 課題4: コンプライアンス対応
- ガバメントクラウド移行方針への未対応
- ISMAP準拠のセキュリティ要件が未実装
- 監査ログの保管・管理が不十分

---

## 3. プロジェクトの目的

### 3.1 主要目的
AWS ECS（Fargate）への移行により、以下を実現する：

1. **運用負荷の削減**
   - サーバーレスコンテナ（Fargate）による運用自動化
   - OSレベルの管理から解放

2. **可用性の向上**
   - マルチAZ構成による高可用性
   - Blue/Greenデプロイによるゼロダウンタイム更新

3. **スケーラビリティの確保**
   - オートスケーリングによる自動的な負荷対応
   - ピーク時の性能問題の解消

4. **コンプライアンス対応**
   - ISMAP準拠のセキュアなアーキテクチャ
   - 政府情報システムの基本方針への準拠
   - 監査ログの適切な保管・管理

### 3.2 期待効果

#### 定量的効果
| 項目 | 現状 | 目標 | 効果 |
|------|------|------|------|
| サーバー管理工数 | 月20時間 | 月5時間 | 75%削減 |
| デプロイ時ダウンタイム | 月1回×10分 | 数分程度（メンテナンス時間中） | 業務影響なし |
| ピーク時応答時間（95%ile） | 5秒以上 | 500ms以内 | 90%改善 |
| ロールバック時間 | 30分以上 | 5分以内 | 83%削減 |
| 可用性 | 98.5% | 99.9% | 1.4pt向上 |

#### 定性的効果
- 緊急出社の削減（夜間・休日のトラブル対応が不要）
- デプロイの標準化・自動化（属人化解消）
- セキュリティ・コンプライアンスレベルの向上
- インフラのコード管理（CloudFormation）による変更履歴の可視化

---

## 4. システム要件（概要）

### 4.1 システム構成

#### アプリケーション構成
| 区分 | 名称 | アクセス方式 | 主要機能 |
|------|------|--------------|----------|
| 業務アプリ（API） | 職員向けシステム | 閉域（VPN経由） | 在庫管理、発注承認、レポート出力 |
| 事業者アプリ（API） | 発注業者向けシステム | パブリック（インターネット） | 伝票閲覧・入力 |
| 業務バッチ | 月次・年次集計処理 | 閉域（定期実行） | レポート生成、データ集計 |

#### 技術スタック
- **アプリケーション**: Node.js 18 + Express（既存継続）
- **データベース**: RDS PostgreSQL 14（新規構築、3環境で共通）
- **フロントエンド**: React 18 SPA（S3 + CloudFront、既存継続）
- **認証**: Amazon Cognito（職員用・事業者用で分離）
- **コンテナ基盤**: AWS ECS Fargate
- **IaC**: AWS CloudFormation
- **CI/CD**: GitHub Actions

#### 環境構成
| 環境 | 用途 | リソーススペック |
|------|------|------------------|
| dev | 開発環境 | 最小構成 |
| stg | ステージング（本番前検証） | 中規模構成 |
| prod | 本番環境 | 本番スペック（オートスケーリング対応） |

### 4.2 非機能要件

#### 可用性
- **目標**: 99.9%（月間43分以内のダウンタイム許容）
- **構成**: マルチAZ構成（ECS、RDS）
- **DR戦略**: 東京リージョン壊滅時に別リージョン（大阪）へ再構築可能な準備

#### 性能
- **レスポンスタイム**: 95%ile < 500ms
- **スケーリング**:
  - 通常時: 最小構成
  - ピーク時: 自動スケーリング（例: 2台 → 5台）

#### セキュリティ・コンプライアンス
- **機密性レベル**: 機密性3（機微情報）
- **準拠規格**: ISMAP、政府情報システムの基本方針
- **ネットワーク**: VPC内部配置、TLS 1.3必須
- **認証**: Cognito（職員用・事業者用で分離）

#### 監視・ログ
- **監視ツール**: Amazon CloudWatch（メトリクス、ログ一元管理）
- **通知先**: メール、Slack、Microsoft Teams
- **ログ保管**: 2年間保管、S3ライフサイクルポリシー活用
  - 直近3ヶ月: CloudWatch Logs
  - 3ヶ月～1年: S3 Standard
  - 1年～2年: S3 Glacier
  - 2年経過: 自動削除

#### バックアップ・リカバリ
- **RDS自動バックアップ**: 1ヶ月保持
- **PITR（ポイントインタイムリカバリ）**: 35日（最長）
- **バックアップ先**: 別リージョン（大阪）へのスナップショットコピー

---

## 5. 制約条件

### 5.1 予算
- **初期構築費用**: 300万円以内（インフラ構築、設計・開発費用）
- **月額運用費用**: 100万円以内（AWS利用料のみ）

### 5.2 納期
- **本番稼働**: 12ヶ月以内
- **リリース方式**: 業務アプリ、事業者アプリ、バッチを同時ローンチ

### 5.3 技術制約
- **既存システムとの連携**:
  - RDS PostgreSQL（新規構築、既存データ移行）
  - 社内ネットワーク（VPN経由でのアクセス）
- **コンプライアンス制約**:
  - ISMAP準拠
  - 政府情報システムの基本方針準拠
  - 機密性3レベルのセキュリティ対策

### 5.4 運用制約
- **デプロイ頻度**: 週1回のペース
- **インフラ管理**: CloudFormationでコード管理
- **運用体制**: インフラ担当者1名（委託）

---

## 6. プロジェクト体制

### 6.1 役割分担
| 役割 | 担当 | 責任範囲 |
|------|------|----------|
| インフラ設計・構築 | 委託（あなた） | AWS環境構築、CloudFormation作成、コンテナ化、CI/CD構築 |
| アプリケーション開発 | 別チーム | Node.js/Express API開発、React SPA開発 |
| プロジェクト管理 | （未定） | スケジュール管理、品質管理 |

### 6.2 インフラ担当者のスキルセット
- AWS経験: 5年
- 対象領域: ECS、RDS、VPC、CloudFormation、GitHub Actions

---

## 7. スケジュール（概算）

| フェーズ | 期間 | 主要成果物 |
|----------|------|------------|
| 企画 | 1ヶ月 | 企画書 |
| 要件定義 | 2ヶ月 | 要件定義書 |
| 設計 | 3ヶ月 | 基本設計書、詳細設計書 |
| 実装 | 4ヶ月 | CloudFormationテンプレート、CI/CDパイプライン、運用ドキュメント |
| テスト | 1ヶ月 | テスト報告書 |
| 移行・稼働 | 1ヶ月 | 本番稼働 |

**合計**: 12ヶ月

---

## 8. リスクと対策

### リスク1: コスト超過
**内容**: AWS利用料が月額100万円を超過するリスク

**対策**:
- 設計フェーズでコスト試算を実施
- リソーススペックを環境ごとに最適化（dev/stgは最小構成）
- CloudWatch Billing Alertで予算超過を早期検知

### リスク2: ISMAP準拠の実装難易度
**内容**: 政府情報システムの要件が厳格で、実装が複雑化するリスク

**対策**:
- 設計フェーズでISMAP要件を詳細調査
- AWSのISMAP対応サービスリストを参照
- 必要に応じてAWSサポート（Enterprise Support）の活用

### リスク3: 既存データ移行の失敗
**内容**: 現行RDSから新規RDSへのデータ移行に失敗するリスク

**対策**:
- 移行リハーサルをstg環境で実施
- AWS Database Migration Service（DMS）の活用検討
- ロールバック手順の事前準備

### リスク4: 納期遅延
**内容**: 12ヶ月で本番稼働できないリスク

**対策**:
- フェーズごとにマイルストーンを設定
- 週次で進捗確認
- クリティカルパスの早期特定

### リスク5: 属人化の再発
**内容**: インフラ担当者が1名のため、属人化が再発するリスク

**対策**:
- すべてのインフラをCloudFormationでコード化
- 運用ドキュメント（デプロイ手順書、トラブルシューティングガイド）を整備
- GitHub Actionsで自動化を徹底

---

## 9. 期待される成果物

### 設計書
- システム構成図
- ネットワーク設計（VPC、サブネット、セキュリティグループ）
- ECS タスク定義
- スケーリング設計
- Blue/Greenデプロイ設計
- DR（災害対策）設計

### インフラコード
- CloudFormation テンプレート（ネットワーク、ECS、RDS、Cognito等）
- デプロイスクリプト（Change Set使用）
- ロールバックスクリプト

### CI/CD
- GitHub Actions ワークフロー（ビルド、テスト、デプロイ）
- Blue/Greenデプロイ設定

### ドキュメント
- デプロイ手順書
- 運用手順書（監視、アラート対応、スケーリング）
- トラブルシューティングガイド
- セキュリティ対策ガイド（ISMAP準拠事項）
- DR（災害復旧）手順書

---

## 10. 承認

### レビュー・承認者
- （未定）

### 承認日
- （未定）

---

**備考**:
- 本企画書は、2025-10-24時点の情報をもとに作成しています。
- 要件定義フェーズで詳細要件が変更される可能性があります。
